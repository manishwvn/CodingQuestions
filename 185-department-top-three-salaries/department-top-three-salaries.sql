WITH E AS (SELECT
        DEPARTMENTID,
        NAME, 
        SALARY,
        DENSE_RANK() OVER(PARTITION BY DEPARTMENTID ORDER BY SALARY DESC) AS RNK
     FROM 
        EMPLOYEE

)


SELECT
    D.NAME AS 'Department',
    E.NAME AS 'Employee',
    E.SALARY AS 'Salary'
    
FROM
    E

JOIN
    DEPARTMENT D
ON 
    E.DEPARTMENTID = D.ID

WHERE
    RNK <= 3;